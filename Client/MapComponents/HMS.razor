@using Treachery.Shared
@inherits MapComponent

@if (h.Game.Map.HiddenMobileStronghold.Visible)
{
    bool isInFrontOfPlayerToken = h.Game.Players.Any(p => Near(h.Game.Map.HiddenMobileStronghold.Center, PlayerTokenPosition(h.Game, p.PositionAtTable), 100));

    <Image X="@(h.Game.Map.HiddenMobileStronghold.Center.X - HiddenMobileStronghold.RADIUS)" 
           Y="@(h.Game.Map.HiddenMobileStronghold.Center.Y - HiddenMobileStronghold.RADIUS)" 
           Width=@(HiddenMobileStronghold.RADIUS + Math.Abs(HiddenMobileStronghold.DX)) Height="@(2 * HiddenMobileStronghold.RADIUS)" 
           Src="@Skin.Current.HMS_URL" 
           ShadowColor="@Skin.Current.SHADOW_DARK" ShadowX="8" ShadowY="8" ShadowBlur="3"
           Opacity="@(!isInFrontOfPlayerToken && h.ShowWheelsAndHMS ? 1.0f : 0.4f)"/>
}
