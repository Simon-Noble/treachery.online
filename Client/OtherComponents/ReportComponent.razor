<!--
 * Copyright 2020-2021 Ronald Ossendrijver. All rights reserved.
--->

@using Treachery.Shared;
@using Treachery.Client.GenericComponents;
@inherits GameComponent

@{
    var messages = Report.Messages.Where(m => m.Target == Faction.None || m.Target == h.Faction).OrderByDescending(m => m.Nr).ToList();

    <div class="card p-1 border-light pb-0">

        <div class="card-header text-center">@Title</div>

        <div class="card-body p-0 overflow-auto small">

            @if (messages.Any())
            {
                foreach (var message in Report.Messages.Where(m => m.Target == Faction.None || m.Target == h.Faction).OrderByDescending(m => m.Nr))
                {
                    <div class="mt-1 pl-1 pr-1" style="background-color:@Skin.Current.GetFactionColor(message.Initiator); @TextColor(message.Initiator); @FontStyle(message)">@message.ToString()</div>
                }
            }
            else
            {
                <div class="mt-1 pl-1 pr-1"><i>Nothing to report.</i></div>
            }

        </div>

    </div>
}

@code {

    [Parameter]
    public Report Report { get; set; }

    [Parameter]
    public string Title { get; set; }

    [Parameter]
    public string Background { get; set; }

    private string TextColor(Faction f) => f == Faction.White || f == Faction.Grey ? "color:black;" : "";

    private string FontStyle(Message m) => m.Target == Faction.None ? "" : "font-style: italic;";
}
